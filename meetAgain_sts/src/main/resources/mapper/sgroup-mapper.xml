<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC
"-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="sgroupMapper">
	<resultMap type="Sgroup" id="sgroupMap">
		<id property="gId" column="GID" />
		<result property="cateId" column="CATE_ID" />
		<result property="setGroup" column="SETGROUP" typeHandler="Str2ArrayHandler"/>
	</resultMap>
	<insert id="insertSgroup" parameterType="Sgroup">
	INSERT INTO SGROUP VALUES(SEQ_GID.NEXTVAL, #{cateId}, #{gTitle}, #{gImg}, #{gIntro}, DEFAULT, #{maxNum}, #{charge}, #{gFee},
	#{gPlace}, #{gType}, #{durate}, DEFAULT, #{gPwd}, NULL, #{setGroup, typeHandler=Str2ArrayHandler})
	</insert>
	
	<insert id="insertgBoard">
	INSERT INTO GBOARD
	VALUES
	(SEQ_GBID.NEXTVAL,#{gbTitle},#{userId},#{gbContent})
	<!-- 전달한 board객체의 boardNo 프로퍼티에 결과값을 담는다. -->
	<selectKey keyProperty="gbId" resultType="_int"
		order="AFTER">
		SELECT SEQ_GBID.CURRVAL FROM DUAL
	</selectKey>
	</insert>


	<resultMap type="Gboard" id="gboardMap">
		<id property="gbId" column="GBID"/>
	</resultMap>
	
	
	<select id="selectgBoardList" resultType="Gboard">
		SELECT GBID, NICKNAME, GBTYPE, GBTITLE, GBRATE, GBDATE, GBDEL
		FROM GBOARD JOIN MEMBER USING(USERID)
		ORDER BY GBID DESC
	</select>
	
	<select id="selectgBoardTotalContent" resultType="_int">
		SELECT COUNT(*)
		FROM GBOARD
	</select>
	
	<select id="selectOnegBoard" parameterType="_int"
		resultType="Gboard">
		SELECT * FROM GBOARD WHERE GBID=#{gbId}
	</select>

	<update id="updategBoard" parameterType="Gboard">
		UPDATE GBOARD SET
		GBTITLE = #{gbTitle}, GBCONTENT=#{gbContent} WHERE GBID=#{gbId}
	</update>
	
	<update id="updateReadCount" parameterType="_int">
		UPDATE GBOARD SET
		GBRATE = GBRATE+1 WHERE GBID=#{gbId}
	</update>
		
</mapper>